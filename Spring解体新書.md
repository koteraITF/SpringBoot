# SpringBoot

## DI(依存性の注入）

依存とは、あるクラスが別のクラスをフィールドで持つことや、メソッドを利用すること。  
注入とは、変数にインスタンスを代入すること。  

例えば、javaにはListというインタフェースがあるが、そのインタフェースを実装したクラスでなければインスタンスを代入できない。  
Listインタフェースを実装したArrayListクラスを注入する場合は以下のようなコードになる。  
```
List<Object> list = new ArrayList<>();
//Listがインタフェースで、ArrayListがクラスで、それらを実装したメソッドがlistである。
```
つまり、依存と注入を合わせて依存性の注入（=DI）となる。  
DIは、インタフェースにインスタンスを自動で代入し、インスタンスの生成と破棄をする。  

## O/Rマッパーとは
ORマッパーとは、Javaクラスとデータベースを関連づけるフレームワーク。

## ServiceとServiceImpl
Serviceはインタフェースとして記述し、そのインタフェースを実行するクラスとしてServiceImplを利用する.

## Transaction
トランザクションの種類は下記の２つ。  
・明示的トランザクション  
・宣言的トランザクション  
明示的トランザクションはコードを直接書くため、ほとんど利用されない。  
宣言的トランザクションはアノテーション@Transactionをつけるだけでトランザクションを実装でき、本質的ではないコードを排除できるため、  基本的に、宣言的トランザクションが利用される。  
また、トランザクション処理は例外が見つかると、自動的にロールバックされる。  

## AOP
AOPとは、共通する処理を抜き出して、まとめて管理することである。  
例えば、コントローラーにメソッドの開始と終わりにメッセージを送る機能を作成することを想定する。  
すると、コントローラーのメソッド毎にメッセージを出力する機能が必要となり、処理を入れ忘れたり、コードの可読性が下がる。  
そこで、AOPを用いて、下記のように設定することで、コントローラーのメソッドの開始と終わりにメッセージを出力する機能をつくれる。  
@Beforeは対象メソッドが実行されるまでに実行される。  
@Afterは対象メソッドが実行されてから実行される。  
また、AOPのクラスには、@Aspectと@Componentアノテーションをつける。
```
@Aspect
@Component
@Slf4j

public class LogAspect{

    @Before("@within(org.springframework.stereotype.controller)")
    public void startLog(JoinPoint jp){
        log.info("メソッド開始");
    }

    @After("@within(org.springframework.stereotype.controller)")
    public void endLog(JoinPoint jp){
        log.info("メソッド終了");
    }
}
```

どのクラスやメソッドをAOPの対象にするかは、@Beforeなどのアノテーション内にexecutionを使って実行対象を指定する。  

## 例外処理
Springで例外処理を行うには、下記3点の方法がある.  
・@AfterThrowingアスペクトでの例外処理  
・コントローラークラス毎の例外処理  
・Webアプリケーション全体の例外処理  

